{
  "_format": "hh3-sol-build-info-1",
  "id": "solc-0_8_28-cecb7847902ba4980807c7b5752f2ed26d490f11",
  "solcVersion": "0.8.28",
  "solcLongVersion": "0.8.28+commit.7893614a",
  "userSourceNameMap": {
    "contracts/Storage.sol": "project/contracts/Storage.sol"
  },
  "input": {
    "language": "Solidity",
    "settings": {
      "evmVersion": "cancun",
      "optimizer": {
        "enabled": true,
        "runs": 200
      },
      "outputSelection": {
        "*": {
          "": [
            "ast"
          ],
          "*": [
            "abi",
            "evm.bytecode",
            "evm.deployedBytecode",
            "evm.methodIdentifiers",
            "metadata"
          ]
        }
      },
      "remappings": [],
      "viaIR": true
    },
    "sources": {
      "project/contracts/Storage.sol": {
        "content": "// SPDX-License-Identifier: MIT\r\npragma solidity ^0.8.20;\r\n\r\ncontract Operations {\r\n    // --- Damage record structure ---\r\n    struct DamageRecord { \r\n        string userId;\r\n        string paddyType;\r\n        uint256 quantity;\r\n        uint256 damageDate;\r\n    }\r\n\r\n    // --- Transaction structure ---\r\n    struct Transaction {\r\n        string fromParty;\r\n        string toParty;\r\n        string productType;\r\n        uint256 quantity;\r\n        uint256 timestamp;\r\n    }\r\n\r\n    // --- Rice Damage record structure ---\r\n    struct RiceDamageRecord { \r\n        string userId;\r\n        string riceType;\r\n        uint256 quantity;\r\n        uint256 damageDate;\r\n    }\r\n\r\n    // --- Rice Transaction structure ---\r\n    struct RiceTransaction {\r\n        string fromParty;\r\n        string toParty;\r\n        string riceType;\r\n        uint256 quantity;\r\n        uint256 timestamp;\r\n    }\r\n\r\n    // --- Milling record structure ---\r\n    struct MillingRecord {\r\n        string millerId;\r\n        string paddyType;\r\n        uint256 inputQty;\r\n        uint256 outputQty;\r\n        uint256 date;\r\n    }\r\n\r\n    // --- Input structs ---\r\n    struct DamageRecordInput {\r\n        string userId;\r\n        string paddyType;\r\n        uint256 quantity;\r\n        uint256 damageDate;\r\n    }\r\n\r\n    struct RiceDamageRecordInput {\r\n        string userId;\r\n        string riceType;\r\n        uint256 quantity;\r\n        uint256 damageDate;\r\n    }\r\n\r\n    struct MillingRecordInput {\r\n        string millerId;\r\n        string paddyType;\r\n        uint256 inputQty;\r\n        uint256 outputQty;\r\n        uint256 date;\r\n    }\r\n\r\n    // --- Damage records ---\r\n    uint256 public nextDamageId;\r\n    mapping(uint256 => DamageRecord) public damageRecords;\r\n\r\n    // --- Transaction tracking ---\r\n    uint256 public nextTxId;\r\n    mapping(uint256 => Transaction) public transactions; // txId -> Transaction\r\n\r\n    // Optional indexes for traceability per actor\r\n    mapping(string => uint256[]) public sentTxs;    // sender name -> txIds\r\n    mapping(string => uint256[]) public receivedTxs; // receiver name -> txIds\r\n\r\n    // --- Rice Damage records ---\r\n    uint256 public nextRiceDamageId;\r\n    mapping(uint256 => RiceDamageRecord) public riceDamageRecords;\r\n\r\n    // --- Rice Transaction tracking ---\r\n    uint256 public nextRiceTxId;\r\n    mapping(uint256 => RiceTransaction) public riceTransactions; // txId -> RiceTransaction\r\n\r\n    // Optional indexes for traceability per actor for rice\r\n    mapping(string => uint256[]) public sentRiceTxs;    // sender name -> txIds\r\n    mapping(string => uint256[]) public receivedRiceTxs; // receiver name -> txIds\r\n\r\n    // --- Milling records ---\r\n    uint256 public nextMillingId;\r\n    mapping(uint256 => MillingRecord) public millingRecords;\r\n\r\n    // --- Events ---\r\n    event DamageRecorded(\r\n        uint256 indexed damageId,\r\n        string userId,\r\n        string paddyType,\r\n        uint256 quantity,\r\n        uint256 damageDate\r\n    );\r\n    \r\n    // Log for off-chain traceability\r\n    event TransactionRecorded(\r\n        uint256 indexed txId,\r\n        string indexed fromParty,\r\n        string indexed toParty,\r\n        string productType,\r\n        uint256 quantity,\r\n        uint256 timestamp\r\n    );\r\n\r\n    event RiceDamageRecorded(\r\n        uint256 indexed damageId,\r\n        string userId,\r\n        string riceType,\r\n        uint256 quantity,\r\n        uint256 damageDate\r\n    );\r\n\r\n    event RiceTransactionRecorded(\r\n        uint256 indexed txId,\r\n        string indexed fromParty,\r\n        string indexed toParty,\r\n        string riceType,\r\n        uint256 quantity,\r\n        uint256 timestamp\r\n    );\r\n\r\n    event MillingRecorded(\r\n        uint256 indexed millingId,\r\n        string millerId,\r\n        string paddyType,\r\n        uint256 inputQty,\r\n        uint256 outputQty,\r\n        uint256 date\r\n    );\r\n\r\n    // --- Transaction recording ---\r\n    function recordTransaction(\r\n        string calldata fromParty,\r\n        string calldata toParty,\r\n        string calldata productType,\r\n        uint256 quantity\r\n    ) external {\r\n        uint256 txId = nextTxId;\r\n        // initialize nextTxId if zero (start at 1)\r\n        if (txId == 0) {\r\n            txId = 1;\r\n            nextTxId = 2;\r\n        } else {\r\n            nextTxId = txId + 1;\r\n        }\r\n\r\n        transactions[txId] = Transaction({\r\n            fromParty: fromParty,\r\n            toParty: toParty,\r\n            productType: productType,\r\n            quantity: quantity,\r\n            timestamp: block.timestamp\r\n        });\r\n\r\n        sentTxs[fromParty].push(txId);\r\n        receivedTxs[toParty].push(txId);\r\n\r\n        emit TransactionRecorded(txId, fromParty, toParty, productType, quantity, block.timestamp);\r\n    }\r\n\r\n    // Return single transaction by id\r\n    function getTransaction(uint256 txId) external view returns (Transaction memory) {\r\n        require(txId != 0 && txId < nextTxId, \"Transaction not found\");\r\n        return transactions[txId];\r\n    }\r\n\r\n    // Return all transactions (for small datasets)\r\n    function getAllTransactions() external view returns (Transaction[] memory) {\r\n        uint256 len = nextTxId == 0 ? 0 : nextTxId - 1;\r\n        Transaction[] memory list = new Transaction[](len);\r\n        for (uint256 i = 0; i < len; i++) {\r\n            list[i] = transactions[i + 1];\r\n        }\r\n        return list;\r\n    }\r\n\r\n    // --- Record Damage ---\r\n    function recordDamage(DamageRecordInput calldata input) external {\r\n        uint256 damageId = nextDamageId;\r\n        if (damageId == 0) {\r\n            damageId = 1;\r\n            nextDamageId = 2;\r\n        } else {\r\n            nextDamageId = damageId + 1;\r\n        }\r\n\r\n        damageRecords[damageId] = DamageRecord({\r\n            userId: input.userId,\r\n            paddyType: input.paddyType,\r\n            quantity: input.quantity,\r\n            damageDate: input.damageDate\r\n        });\r\n\r\n        emit DamageRecorded(\r\n            damageId,\r\n            input.userId,\r\n            input.paddyType,\r\n            input.quantity,\r\n            input.damageDate\r\n        );\r\n    }\r\n\r\n    // Get damage record\r\n    function getDamageRecord(uint256 _damageId) external view returns (DamageRecord memory) {\r\n        require(_damageId != 0 && _damageId < nextDamageId, \"Damage record not found\");\r\n        return damageRecords[_damageId];\r\n    }\r\n\r\n    // Return all damage records\r\n    function getAllDamageRecords() external view returns (DamageRecord[] memory) {\r\n        uint256 len = nextDamageId == 0 ? 0 : nextDamageId - 1;\r\n        DamageRecord[] memory list = new DamageRecord[](len);\r\n        for (uint256 i = 0; i < len; i++) {\r\n            list[i] = damageRecords[i + 1];\r\n        }\r\n        return list;\r\n    }\r\n\r\n    // --- Rice Transaction recording ---\r\n    function recordRiceTransaction(\r\n        string calldata fromParty,\r\n        string calldata toParty,\r\n        string calldata riceType,\r\n        uint256 quantity\r\n    ) external {\r\n        uint256 txId = nextRiceTxId;\r\n        // initialize nextRiceTxId if zero (start at 1)\r\n        if (txId == 0) {\r\n            txId = 1;\r\n            nextRiceTxId = 2;\r\n        } else {\r\n            nextRiceTxId = txId + 1;\r\n        }\r\n\r\n        riceTransactions[txId] = RiceTransaction({\r\n            fromParty: fromParty,\r\n            toParty: toParty,\r\n            riceType: riceType,\r\n            quantity: quantity,\r\n            timestamp: block.timestamp\r\n        });\r\n\r\n        sentRiceTxs[fromParty].push(txId);\r\n        receivedRiceTxs[toParty].push(txId);\r\n\r\n        emit RiceTransactionRecorded(txId, fromParty, toParty, riceType, quantity, block.timestamp);\r\n    }\r\n\r\n    // Return single rice transaction by id\r\n    function getRiceTransaction(uint256 txId) external view returns (RiceTransaction memory) {\r\n        require(txId != 0 && txId < nextRiceTxId, \"Rice transaction not found\");\r\n        return riceTransactions[txId];\r\n    }\r\n\r\n    // Return all rice transactions (for small datasets)\r\n    function getAllRiceTransactions() external view returns (RiceTransaction[] memory) {\r\n        uint256 len = nextRiceTxId == 0 ? 0 : nextRiceTxId - 1;\r\n        RiceTransaction[] memory list = new RiceTransaction[](len);\r\n        for (uint256 i = 0; i < len; i++) {\r\n            list[i] = riceTransactions[i + 1];\r\n        }\r\n        return list;\r\n    }\r\n\r\n    // --- Record Rice Damage ---\r\n    function recordRiceDamage(RiceDamageRecordInput calldata input) external {\r\n        uint256 damageId = nextRiceDamageId;\r\n        if (damageId == 0) {\r\n            damageId = 1;\r\n            nextRiceDamageId = 2;\r\n        } else {\r\n            nextRiceDamageId = damageId + 1;\r\n        }\r\n\r\n        riceDamageRecords[damageId] = RiceDamageRecord({\r\n            userId: input.userId,\r\n            riceType: input.riceType,\r\n            quantity: input.quantity,\r\n            damageDate: input.damageDate\r\n        });\r\n\r\n        emit RiceDamageRecorded(\r\n            damageId,\r\n            input.userId,\r\n            input.riceType,\r\n            input.quantity,\r\n            input.damageDate\r\n        );\r\n    }\r\n\r\n    // Get single rice damage record\r\n    function getRiceDamageRecord(uint256 _damageId) external view returns (RiceDamageRecord memory) {\r\n        require(_damageId != 0 && _damageId < nextRiceDamageId, \"Rice damage record not found\");\r\n        return riceDamageRecords[_damageId];\r\n    }\r\n\r\n    // Return all rice damage records\r\n    function getAllRiceDamageRecords() external view returns (RiceDamageRecord[] memory) {\r\n        uint256 len = nextRiceDamageId == 0 ? 0 : nextRiceDamageId - 1;\r\n        RiceDamageRecord[] memory list = new RiceDamageRecord[](len);\r\n        for (uint256 i = 0; i < len; i++) {\r\n            list[i] = riceDamageRecords[i + 1];\r\n        }\r\n        return list;\r\n    }\r\n\r\n    // --- Record Milling ---\r\n    function recordMilling(MillingRecordInput calldata input) external {\r\n        uint256 millingId = nextMillingId;\r\n        if (millingId == 0) {\r\n            millingId = 1;\r\n            nextMillingId = 2;\r\n        } else {\r\n            nextMillingId = millingId + 1;\r\n        }\r\n\r\n        millingRecords[millingId] = MillingRecord({\r\n            millerId: input.millerId,\r\n            paddyType: input.paddyType,\r\n            inputQty: input.inputQty,\r\n            outputQty: input.outputQty,\r\n            date: input.date\r\n        });\r\n\r\n        emit MillingRecorded(\r\n            millingId,\r\n            input.millerId,\r\n            input.paddyType,\r\n            input.inputQty,\r\n            input.outputQty,\r\n            input.date\r\n        );\r\n    }\r\n\r\n    // Get single milling record\r\n    function getMillingRecord(uint256 _millingId) external view returns (MillingRecord memory) {\r\n        require(_millingId != 0 && _millingId < nextMillingId, \"Milling record not found\");\r\n        return millingRecords[_millingId];\r\n    }\r\n\r\n    // Return all milling records\r\n    function getAllMillingRecords() external view returns (MillingRecord[] memory) {\r\n        uint256 len = nextMillingId == 0 ? 0 : nextMillingId - 1;\r\n        MillingRecord[] memory list = new MillingRecord[](len);\r\n        for (uint256 i = 0; i < len; i++) {\r\n            list[i] = millingRecords[i + 1];\r\n        }\r\n        return list;\r\n    }\r\n}\r\n"
      }
    }
  }
}