{
  "_format": "hh3-sol-build-info-1",
  "id": "solc-0_8_28-d3a8488c840fb76a7c3c2a48d9030e0560206bac",
  "solcVersion": "0.8.28",
  "solcLongVersion": "0.8.28+commit.7893614a",
  "userSourceNameMap": {
    "contracts/Storage.sol": "project/contracts/Storage.sol"
  },
  "input": {
    "language": "Solidity",
    "settings": {
      "evmVersion": "cancun",
      "optimizer": {
        "enabled": true,
        "runs": 200
      },
      "outputSelection": {
        "*": {
          "": [
            "ast"
          ],
          "*": [
            "abi",
            "evm.bytecode",
            "evm.deployedBytecode",
            "evm.methodIdentifiers",
            "metadata"
          ]
        }
      },
      "remappings": []
    },
    "sources": {
      "project/contracts/Storage.sol": {
        "content": "// SPDX-License-Identifier: MIT\r\npragma solidity ^0.8.20;\r\n\r\ncontract Storage {\r\n    // --- Farmer structure ---\r\n    struct Farmer {\r\n        string id; // Government-issued ID\r\n        string nic;\r\n        string fullName;\r\n        string homeAddress;\r\n        string district;\r\n        string contactNumber;\r\n        uint256 totalPaddyFieldArea;\r\n    }\r\n\r\n    // --- Collector structure ---\r\n    struct Collector {\r\n        string id;\r\n        string nic;\r\n        string fullName;\r\n        string homeAddress;\r\n        string district;\r\n        string contactNumber;\r\n    }\r\n\r\n    // --- Miller structure ---\r\n    struct Miller {\r\n        string id;\r\n        string companyRegisterNumber;\r\n        string companyName;\r\n        string homeAddress;\r\n        string district;\r\n        string contactNumber;\r\n    }\r\n\r\n    // --- Transaction structure ---\r\n    struct Transaction {\r\n        string fromParty;\r\n        string toParty;\r\n        string productType;\r\n        uint256 quantity;\r\n        uint256 timestamp;\r\n    }\r\n\r\n    // --- Input structs for registration ---\r\n    struct FarmerInput {\r\n        string id;\r\n        string nic;\r\n        string fullName;\r\n        string homeAddress;\r\n        string district;\r\n        string contactNumber;\r\n        uint256 totalPaddyFieldArea;\r\n    }\r\n\r\n    struct CollectorInput {\r\n        string id;\r\n        string nic;\r\n        string fullName;\r\n        string homeAddress;\r\n        string district;\r\n        string contactNumber;\r\n    }\r\n\r\n    struct MillerInput {\r\n        string id;\r\n        string companyRegisterNumber;\r\n        string companyName;\r\n        string homeAddress;\r\n        string district;\r\n        string contactNumber;\r\n    }\r\n\r\n    // --- Storage mappings ---\r\n    mapping(string => Farmer) public farmers;\r\n    mapping(string => Collector) public collectors;\r\n    mapping(string => Miller) public millers;\r\n    // Keep a list of registered farmer IDs so we can enumerate farmers\r\n    string[] public farmerIds;\r\n    // Keep a list of registered miller IDs so we can enumerate millers\r\n    string[] public millerIds;\r\n    // Keep a list of registered collector IDs so we can enumerate collectors\r\n    string[] public collectorIds;\r\n\r\n    // --- Transaction tracking ---\r\n    uint256 public nextTxId;\r\n    mapping(uint256 => Transaction) public transactions; // txId -> Transaction\r\n\r\n    // Optional indexes for traceability per actor\r\n    mapping(string => uint256[]) public sentTxs;    // sender name -> txIds\r\n    mapping(string => uint256[]) public receivedTxs; // receiver name -> txIds\r\n\r\n    // --- Events ---\r\n    event FarmerRegistered(string id, string fullName);\r\n    event CollectorRegistered(string id, string fullName);\r\n    event MillerRegistered(string id, string companyName);\r\n    \r\n    // Log for off-chain traceability\r\n    event TransactionRecorded(\r\n        uint256 indexed txId,\r\n        string indexed fromParty,\r\n        string indexed toParty,\r\n        string productType,\r\n        uint256 quantity,\r\n        uint256 timestamp\r\n    );\r\n\r\n    // --- Transaction recording ---\r\n    function recordTransaction(\r\n        string calldata fromParty,\r\n        string calldata toParty,\r\n        string calldata productType,\r\n        uint256 quantity\r\n    ) external {\r\n        uint256 txId = nextTxId;\r\n        // initialize nextTxId if zero (start at 1)\r\n        if (txId == 0) {\r\n            txId = 1;\r\n            nextTxId = 2;\r\n        } else {\r\n            nextTxId = txId + 1;\r\n        }\r\n\r\n        transactions[txId] = Transaction({\r\n            fromParty: fromParty,\r\n            toParty: toParty,\r\n            productType: productType,\r\n            quantity: quantity,\r\n            timestamp: block.timestamp\r\n        });\r\n\r\n        sentTxs[fromParty].push(txId);\r\n        receivedTxs[toParty].push(txId);\r\n\r\n        emit TransactionRecorded(txId, fromParty, toParty, productType, quantity, block.timestamp);\r\n    }\r\n\r\n    // Return single transaction by id\r\n    function getTransaction(uint256 txId) external view returns (Transaction memory) {\r\n        require(txId != 0 && txId < nextTxId, \"Transaction not found\");\r\n        return transactions[txId];\r\n    }\r\n\r\n    // Return all transactions (for small datasets)\r\n    function getAllTransactions() external view returns (Transaction[] memory) {\r\n        uint256 len = nextTxId == 0 ? 0 : nextTxId - 1;\r\n        Transaction[] memory list = new Transaction[](len);\r\n        for (uint256 i = 0; i < len; i++) {\r\n            list[i] = transactions[i + 1];\r\n        }\r\n        return list;\r\n    }\r\n\r\n    // --- Register Farmer ---\r\n    function registerFarmer(FarmerInput calldata input) external {\r\n        require(bytes(farmers[input.id].id).length == 0, \"Farmer already registered\");\r\n\r\n        farmers[input.id] = Farmer({\r\n            id: input.id,\r\n            nic: input.nic,\r\n            fullName: input.fullName,\r\n            homeAddress: input.homeAddress,\r\n            district: input.district,\r\n            contactNumber: input.contactNumber,\r\n            totalPaddyFieldArea: input.totalPaddyFieldArea\r\n        });\r\n\r\n        // track id for enumeration\r\n        farmerIds.push(input.id);\r\n\r\n        emit FarmerRegistered(input.id, input.fullName);\r\n    }\r\n\r\n    // --- Register Collector ---\r\n    function registerCollector(CollectorInput calldata input) external {\r\n        require(bytes(collectors[input.id].id).length == 0, \"Collector already registered\");\r\n\r\n        collectors[input.id] = Collector({\r\n            id: input.id,\r\n            nic: input.nic,\r\n            fullName: input.fullName,\r\n            homeAddress: input.homeAddress,\r\n            district: input.district,\r\n            contactNumber: input.contactNumber\r\n        });\r\n\r\n        // track id for enumeration\r\n        collectorIds.push(input.id);\r\n\r\n        emit CollectorRegistered(input.id, input.fullName);\r\n    }\r\n\r\n    // --- Register Miller ---\r\n    function registerMiller(MillerInput calldata input) external {\r\n        require(bytes(millers[input.id].id).length == 0, \"Miller already registered\");\r\n\r\n        millers[input.id] = Miller({\r\n            id: input.id,\r\n            companyRegisterNumber: input.companyRegisterNumber,\r\n            companyName: input.companyName,\r\n            homeAddress: input.homeAddress,\r\n            district: input.district,\r\n            contactNumber: input.contactNumber\r\n        });\r\n\r\n        // track id for enumeration\r\n        millerIds.push(input.id);\r\n\r\n        emit MillerRegistered(input.id, input.companyName);\r\n    }\r\n\r\n    // --- View functions ---\r\n    function getFarmer(string calldata _id) external view returns (Farmer memory) {\r\n        require(bytes(farmers[_id].id).length != 0, \"Farmer not found\");\r\n        return farmers[_id];\r\n    }\r\n\r\n    function getCollector(string calldata _id) external view returns (Collector memory) {\r\n        require(bytes(collectors[_id].id).length != 0, \"Collector not found\");\r\n        return collectors[_id];\r\n    }\r\n\r\n    function getMiller(string calldata _id) external view returns (Miller memory) {\r\n        require(bytes(millers[_id].id).length != 0, \"Miller not found\");\r\n        return millers[_id];\r\n    }\r\n\r\n    // Return all registered farmer IDs\r\n    function getFarmerIds() external view returns (string[] memory) {\r\n        return farmerIds;\r\n    }\r\n\r\n    // Return all registered farmers\r\n    function getAllFarmers() external view returns (Farmer[] memory) {\r\n        uint256 len = farmerIds.length;\r\n        Farmer[] memory list = new Farmer[](len);\r\n        for (uint256 i = 0; i < len; i++) {\r\n            list[i] = farmers[farmerIds[i]];\r\n        }\r\n        return list;\r\n    }\r\n\r\n    // Return all registered miller IDs\r\n    function getMillerIds() external view returns (string[] memory) {\r\n        return millerIds;\r\n    }\r\n\r\n    // Return all registered collector IDs\r\n    function getCollectorIds() external view returns (string[] memory) {\r\n        return collectorIds;\r\n    }\r\n\r\n    // Return all registered collectors\r\n    function getAllCollectors() external view returns (Collector[] memory) {\r\n        uint256 len = collectorIds.length;\r\n        Collector[] memory list = new Collector[](len);\r\n        for (uint256 i = 0; i < len; i++) {\r\n            list[i] = collectors[collectorIds[i]];\r\n        }\r\n        return list;\r\n    }\r\n\r\n    // Return all registered millers\r\n    function getAllMillers() external view returns (Miller[] memory) {\r\n        uint256 len = millerIds.length;\r\n        Miller[] memory list = new Miller[](len);\r\n        for (uint256 i = 0; i < len; i++) {\r\n            list[i] = millers[millerIds[i]];\r\n        }\r\n        return list;\r\n    }\r\n}\r\n"
      }
    }
  }
}