{
  "_format": "hh3-sol-build-info-1",
  "id": "solc-0_8_28-4694a35cde938af91c1fccc262c3ef957d4ae9e0",
  "solcVersion": "0.8.28",
  "solcLongVersion": "0.8.28+commit.7893614a",
  "userSourceNameMap": {
    "contracts/Storage.sol": "project/contracts/Storage.sol"
  },
  "input": {
    "language": "Solidity",
    "settings": {
      "evmVersion": "cancun",
      "optimizer": {
        "enabled": true,
        "runs": 200
      },
      "outputSelection": {
        "*": {
          "": [
            "ast"
          ],
          "*": [
            "abi",
            "evm.bytecode",
            "evm.deployedBytecode",
            "evm.methodIdentifiers",
            "metadata"
          ]
        }
      },
      "remappings": []
    },
    "sources": {
      "project/contracts/Storage.sol": {
        "content": "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.20;\n\ncontract Storage {\n    // --- Farmer structure ---\n    struct Farmer {\n        string id; // Government-issued ID\n        string nic;\n        string fullName;\n        string homeAddress;\n        string district;\n        string contactNumber;\n        uint256 totalPaddyFieldArea;\n    }\n\n    // --- Collector structure ---\n    struct Collector {\n        string id;\n        string nic;\n        string fullName;\n        string homeAddress;\n        string district;\n        string contactNumber;\n    }\n\n    // --- Miller structure ---\n    struct Miller {\n        string id;\n        string companyRegisterNumber;\n        string companyName;\n        string homeAddress;\n        string district;\n        string contactNumber;\n    }\n\n    // --- Transaction structure ---\n    struct Transaction {\n        string fromParty;\n        string toParty;\n        string productType;\n        uint256 quantity;\n        uint256 timestamp;\n    }\n\n    // --- Input structs for registration ---\n    struct FarmerInput {\n        string id;\n        string nic;\n        string fullName;\n        string homeAddress;\n        string district;\n        string contactNumber;\n        uint256 totalPaddyFieldArea;\n    }\n\n    struct CollectorInput {\n        string id;\n        string nic;\n        string fullName;\n        string homeAddress;\n        string district;\n        string contactNumber;\n    }\n\n    struct MillerInput {\n        string id;\n        string companyRegisterNumber;\n        string companyName;\n        string homeAddress;\n        string district;\n        string contactNumber;\n    }\n\n    // --- Storage mappings ---\n    mapping(string => Farmer) public farmers;\n    mapping(string => Collector) public collectors;\n    mapping(string => Miller) public millers;\n    // Keep a list of registered farmer IDs so we can enumerate farmers\n    string[] public farmerIds;\n    // Keep a list of registered miller IDs so we can enumerate millers\n    string[] public millerIds;\n    // Keep a list of registered collector IDs so we can enumerate collectors\n    string[] public collectorIds;\n\n    // --- Transaction tracking ---\n    uint256 public nextTxId;\n    mapping(uint256 => Transaction) public transactions; // txId -> Transaction\n\n    // Optional indexes for traceability per actor\n    mapping(string => uint256[]) public sentTxs;    // sender name -> txIds\n    mapping(string => uint256[]) public receivedTxs; // receiver name -> txIds\n\n    // --- Events ---\n    event FarmerRegistered(string id, string fullName);\n    event CollectorRegistered(string id, string fullName);\n    event MillerRegistered(string id, string companyName);\n    \n    // Log for off-chain traceability\n    event TransactionRecorded(\n        uint256 indexed txId,\n        string indexed fromParty,\n        string indexed toParty,\n        string productType,\n        uint256 quantity,\n        uint256 timestamp\n    );\n\n    // --- Transaction recording ---\n    function recordTransaction(\n        string calldata fromParty,\n        string calldata toParty,\n        string calldata productType,\n        uint256 quantity\n    ) external {\n        uint256 txId = nextTxId;\n        // initialize nextTxId if zero (start at 1)\n        if (txId == 0) {\n            txId = 1;\n            nextTxId = 2;\n        } else {\n            nextTxId = txId + 1;\n        }\n\n        transactions[txId] = Transaction({\n            fromParty: fromParty,\n            toParty: toParty,\n            productType: productType,\n            quantity: quantity,\n            timestamp: block.timestamp\n        });\n\n        sentTxs[fromParty].push(txId);\n        receivedTxs[toParty].push(txId);\n\n        emit TransactionRecorded(txId, fromParty, toParty, productType, quantity, block.timestamp);\n    }\n\n    // Return single transaction by id\n    function getTransaction(uint256 txId) external view returns (Transaction memory) {\n        require(txId != 0 && txId < nextTxId, \"Transaction not found\");\n        return transactions[txId];\n    }\n\n    // Return all transactions (for small datasets)\n    function getAllTransactions() external view returns (Transaction[] memory) {\n        uint256 len = nextTxId == 0 ? 0 : nextTxId - 1;\n        Transaction[] memory list = new Transaction[](len);\n        for (uint256 i = 0; i < len; i++) {\n            list[i] = transactions[i + 1];\n        }\n        return list;\n    }\n\n    // --- Register Farmer ---\n    function registerFarmer(FarmerInput calldata input) external {\n        require(bytes(farmers[input.id].id).length == 0, \"Farmer already registered\");\n\n        farmers[input.id] = Farmer({\n            id: input.id,\n            nic: input.nic,\n            fullName: input.fullName,\n            homeAddress: input.homeAddress,\n            district: input.district,\n            contactNumber: input.contactNumber,\n            totalPaddyFieldArea: input.totalPaddyFieldArea\n        });\n\n        // track id for enumeration\n        farmerIds.push(input.id);\n\n        emit FarmerRegistered(input.id, input.fullName);\n    }\n\n    // --- Register Collector ---\n    function registerCollector(CollectorInput calldata input) external {\n        require(bytes(collectors[input.id].id).length == 0, \"Collector already registered\");\n\n        collectors[input.id] = Collector({\n            id: input.id,\n            nic: input.nic,\n            fullName: input.fullName,\n            homeAddress: input.homeAddress,\n            district: input.district,\n            contactNumber: input.contactNumber\n        });\n\n        // track id for enumeration\n        collectorIds.push(input.id);\n\n        emit CollectorRegistered(input.id, input.fullName);\n    }\n\n    // --- Register Miller ---\n    function registerMiller(MillerInput calldata input) external {\n        require(bytes(millers[input.id].id).length == 0, \"Miller already registered\");\n\n        millers[input.id] = Miller({\n            id: input.id,\n            companyRegisterNumber: input.companyRegisterNumber,\n            companyName: input.companyName,\n            homeAddress: input.homeAddress,\n            district: input.district,\n            contactNumber: input.contactNumber\n        });\n\n        // track id for enumeration\n        millerIds.push(input.id);\n\n        emit MillerRegistered(input.id, input.companyName);\n    }\n\n    // --- View functions ---\n    function getFarmer(string calldata _id) external view returns (Farmer memory) {\n        require(bytes(farmers[_id].id).length != 0, \"Farmer not found\");\n        return farmers[_id];\n    }\n\n    function getCollector(string calldata _id) external view returns (Collector memory) {\n        require(bytes(collectors[_id].id).length != 0, \"Collector not found\");\n        return collectors[_id];\n    }\n\n    function getMiller(string calldata _id) external view returns (Miller memory) {\n        require(bytes(millers[_id].id).length != 0, \"Miller not found\");\n        return millers[_id];\n    }\n\n    // Return all registered farmer IDs\n    function getFarmerIds() external view returns (string[] memory) {\n        return farmerIds;\n    }\n\n    // Return all registered farmers\n    function getAllFarmers() external view returns (Farmer[] memory) {\n        uint256 len = farmerIds.length;\n        Farmer[] memory list = new Farmer[](len);\n        for (uint256 i = 0; i < len; i++) {\n            list[i] = farmers[farmerIds[i]];\n        }\n        return list;\n    }\n\n    // Return all registered miller IDs\n    function getMillerIds() external view returns (string[] memory) {\n        return millerIds;\n    }\n\n    // Return all registered collector IDs\n    function getCollectorIds() external view returns (string[] memory) {\n        return collectorIds;\n    }\n\n    // Return all registered collectors\n    function getAllCollectors() external view returns (Collector[] memory) {\n        uint256 len = collectorIds.length;\n        Collector[] memory list = new Collector[](len);\n        for (uint256 i = 0; i < len; i++) {\n            list[i] = collectors[collectorIds[i]];\n        }\n        return list;\n    }\n\n    // Return all registered millers\n    function getAllMillers() external view returns (Miller[] memory) {\n        uint256 len = millerIds.length;\n        Miller[] memory list = new Miller[](len);\n        for (uint256 i = 0; i < len; i++) {\n            list[i] = millers[millerIds[i]];\n        }\n        return list;\n    }\n}\n"
      }
    }
  }
}